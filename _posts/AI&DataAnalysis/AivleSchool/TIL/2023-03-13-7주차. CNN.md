---
title:  "[KT Aivle 3ê¸° AI] 7ì£¼ì°¨ (28~32ì¼ì°¨). CNN(Convolutional Neural Network)"
author: JIHWAN PARK
categories: [AI & ë°ì´í„°ë¶„ì„, AIVLE SCHOOL]
tag: [AIVLE SCHOOL, Machine Learning, Deep Learning, CNN]
math: true
date: 2023-03-13 18:00:00 +0900
last_modified_at: 2023-03-16 20:43:22 +0900
---
> KT Aivle School 3ê¸° AI 28~29ì¼ì°¨ 
> - ê°•ì‚¬ : ê¹€ê±´ì˜ ê°•ì‚¬ë‹˜
> - ì£¼ì œ : CNN(Convolutional Neural Network)
> - ë‚´ìš© :
>   - CNNì— ëŒ€í•´ì„œ ë°°ì›€
>   - stride, zero-padding, Max Pooling ë“±ì— ëŒ€í•´ ë°°ì›€
>   - Image Data Augmentation ì— ëŒ€í•´ì„œ ë°°ìš°ê³  ì‹¤ìŠµ
>   - Pretrained Model, Transfer Learning
>   - ModelCheckpoint, model.save()
>   - Object Detection, YOLO
{: .prompt-info}

## ğŸ’¡ 28ì¼ì°¨. TIL
<details>
<summary>28ì¼ì°¨(3/13)</summary>
<div markdown="1">
ì˜¤ëŠ˜ì€ CNNì— ëŒ€í•´ì„œ ë°°ì› ë‹¤. ì´ë¯¸ í•™ë¶€ë•Œ ë°°ì› ë˜ ë‚´ìš©ì´ë¼ ë‹¤ì‹œ ê¸°ì–µì„ ìƒê¸°ì‹œí‚¤ë©° ë“¤ì—ˆë‹¤. 

CNNì´ ë‚˜ì˜¤ê²Œ ëœ ê³„ê¸° : ì´ë¯¸ì§€ì˜ ìœ„ì¹˜ì •ë³´ë¥¼ ì—†ì• ì§€ ì•Šê³  ì²˜ë¦¬í•˜ê¸° ìœ„í•¨

CNN ì—°ì‚°ì—ëŠ” kernel_sizeì™€ strideê°€ ì˜í–¥ì„ ë¯¸ì¹˜ë©°, ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ì´ì¦ˆê°€ ì‘ì•„ì§€ê³  í•©ì„±ê³±ì˜ ë¶ˆê· í˜•ì´ ìƒê¸´ë‹¤.

CNN ì—°ì‚° ê²°ê³¼ í¬ê¸° ê³µì‹ : `output_size = (N - F) / stride + 1`

ì‚¬ì´ì¦ˆê°€ ì‘ì•„ì§€ê³  í•©ì„±ê³±ì˜ ë¶ˆê· í˜•ì„ í•´ê²°í•˜ê¸° ìœ„í•´ zero-paddingì´ë¼ëŠ” ê¸°ë²•ì´ ìƒê²¼ë‹¤.

ê·¸ë¦¬ê³ , ì—°ì‚°ëŸ‰ì„ ì¤„ì´ê¸° ìœ„í•´ Max Poolingì´ë¼ëŠ” ê¸°ë²•ì´ ìƒê²¼ëŠ”ë°, Max Poolingì€ filter_sizeì—ì„œ ê°€ì¥ í° ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ë‹¤.

~~`relu` í•¨ìˆ˜ë¥¼ ì£¼ë¡œ ì“°ëŠ” ìƒí™©ì—ì„œ Max Poolingì´ ê°€ì¥ ì•Œë§ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤?~~

ê·¸ë¦¬ê³ , Batch Normalizationê³¼ Dropoutì— ëŒ€í•´ ê°„ë‹¨í•˜ê²Œ ë°°ìš°ê³  ì‚¬ìš©í–ˆëŠ”ë°, ë‘˜ ë‹¤ ëª¨ë¸ì„ Robustí•˜ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ê¸°ëŠ¥ì´ë‹¤.

Batch Normalizationì€ mini batchë¥¼ ì •ê·œí™” ì‹œì¼œì£¼ê³ , Dropoutì€ ì§€ì •í•œ ë¹„ìœ¨ë¡œ ëœë¤í•˜ê²Œ ë…¸ë“œë¥¼ ì£½ì´ê²Œ ë˜ì–´ ì´ˆê¸° weight ê°’ì— ëœ ë¯¼ê°í•˜ê²Œ ë§Œë“¤ì–´ ì¤€ë‹¤.

yê°€ ë²”ì£¼í˜•ì¸ë° numericalìœ¼ë¡œ ìˆëŠ” ê²½ìš° (ex: y = [1, 2, 3, 4, 5, ...]) ì›ë˜ëŠ” `to_categorical`ìœ¼ë¡œ ì „ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼ í•˜ì§€ë§Œ,

ì „ì²˜ë¦¬ ì—†ì´ `loss = keras.losses.sparse_categorical_crossentropy`ì„ ì‚¬ìš©í•˜ë©´ í•™ìŠµ ê°€ëŠ¥í•˜ë‹¤.


<a href='https://github.com/Jihwan98/aivle_school/tree/main/2023.03.13.CNN_2.0ver/1_My_First_CNN' target='_blank'>[CNN ê´€ë ¨ ì½”ë“œ]</a>

CNN Modeling ì˜ˆì‹œ ì½”ë“œ

```python
# 1. ì„¸ì…˜ í´ë¦¬ì–´
keras.backend.clear_session()

# 2. ëª¨ë¸ ì—°ê²°
il = Input(shape=(28, 28, 1))
cl = Conv2D(filters=32, kernel_size=(3, 3), padding='same', activation='relu')(il)
bl = BatchNormalization()(cl)
cl = Conv2D(filters=32, kernel_size=(3, 3), padding='same', activation='relu')(bl)
bl = BatchNormalization()(cl)
pl = MaxPool2D(pool_size=(2, 2))(bl)
dl = Dropout(0.25)(pl)

cl = Conv2D(filters=64, kernel_size=(3, 3), padding='same', activation='relu')(il)
bl = BatchNormalization()(cl)
cl = Conv2D(filters=64, kernel_size=(3, 3), padding='same', activation='relu')(bl)
bl = BatchNormalization()(cl)
pl = MaxPool2D(pool_size=(2, 2))(bl)
dl = Dropout(0.25)(pl)

fl = Flatten()(dl)
dl = Dense(512, activation='relu')(fl)
bl = BatchNormalization()(dl)
ol = Dense(10, activation='softmax')(bl)

model = keras.models.Model(il, ol)

# 3. ëª¨ë¸ ì»´íŒŒì¼
model.compile(loss=keras.losses.sparse_categorical_crossentropy, metrics=['accuracy'], optimizer='adam')

# 4. ìš”ì•½
model.summary()
```
</div>
</details>


## ğŸ’¡ 29ì¼ì°¨. TIL
<details>
<summary>29ì¼ì°¨(3/14)</summary>
<div markdown="1">
ì˜¤ëŠ˜ì€ ì–´ì œì— ì´ì–´ CNN ëª¨ë¸ì„ ë§Œë“¤ê³  í•™ìŠµì„ ì§„í–‰í–ˆë‹¤.

ê·¸ë¦¬ê³  Image Data Augmentationì— ëŒ€í•´ ê°„ëµíˆ ë°°ìš°ê³  ì‹¤ìŠµì„ ì§„í–‰í–ˆë‹¤.

ì‹¤ì œ í˜„ì‹¤ì—ì„œëŠ” ì¶©ë¶„í•œ Dataê°€ ìˆì§€ ì•Šìœ¼ë¯€ë¡œ, ë¶€ì¡±í•œ ë°ì´í„°ë¥¼ ì±„ì›Œì£¼ê¸° ìœ„í•´ ê¸°ì¡´ì˜ ë°ì´í„°ë¥¼ ì¡°ê¸ˆ ë³€í˜• ì‹œì¼œ ë°ì´í„°ë¥¼ ëŠ˜ë¦¬ëŠ” ë°©ë²•ì´ Data Augmentationì´ë‹¤.

ì´ë¥¼ kerasì˜ ImageDataGeneratorë¥¼ í†µí•´ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.

<a href='https://github.com/Jihwan98/aivle_school/tree/main/2023.03.13.CNN_2.0ver/2_Data_augmentation_and_more' target='_blank'>[Augmentaion ê´€ë ¨ ì½”ë“œ]</a>

</div>
</details>

## ğŸ’¡ 30ì¼ì°¨. TIL
<details>
<summary>30ì¼ì°¨(3/15)</summary>
<div markdown="1">
- ëª¨ë¸ì„ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ì„ ë°°ì›€(ModelCheckpoint, model.save())
- Transfer Learning : Pretrained Modelì„ ê°€ì ¸ì™€ì„œ ìš°ë¦¬ ë¬¸ì œì— ë§ê²Œ êµ¬ì¡°ë¥¼ ì‚´ì§ ë°”ê¿” í•™ìŠµì‹œí‚¨ë‹¤. ex) input ~ hidden layer ê¹Œì§€ Frozen (weight update x), output ì§ì „ ë˜ëŠ” output layerë§Œ ê³ ì³ì“°ê¸°
- ReduceLROnPlateau : Learning Rate ì¡°ì ˆí•˜ëŠ” ë„êµ¬
- Global Average Pooling : Feature Mapì˜ ê° depthì˜ í‰ê· ì„ ê°€ì ¸ì˜´ -> ì—°ì‚°ëŸ‰ ì¤„ì´ê¸°
- Object Detection ë§›ë³´ê¸° : YOLO V3 ê°€ì ¸ì™€ì„œ ì‚¬ìš©í•´ë³´ê¸°
<details>
<summary>Object Detection</summary>
<div markdown="1">
- object detection = Classification + Localization = Multi-Labeled Classification + Bounding Box Regression
- ì£¼ìš” í•™ìŠµ ë°ì´í„°
    - Pascal VOC Dataset
        - mAP(mean Average Precision) ë“±ì¥
        - 2007ë…„ 2012ë…„ ë°ì´í„°ì…‹ì´ ë²¤ì¹˜ë§ˆí¬ ë°ì´í„°ì…‹ìœ¼ë¡œ ì£¼ë¡œ ì“°ì˜€ìŒ
        - ë¬¸ì œì 
            - ì´ë¯¸ì§€ ì•ˆì˜ objectê°€ í¬ê°€
            - objectê°€ ì´ë¯¸ì§€ ì¤‘ì•™ì— ìˆë‹¤.
            - objectì˜ ì¢…ë¥˜ê°€ ì ë‹¤(20ê°œ)
    - COCO Dataset
        - ê¸°ì¡´ ë°ì´í„°ì…‹ì— ëŒ€í•œ ë¬¸ì œ ì œê¸°
        - í˜„ì¬ ë§ì´ ì“°ì„
        - object í¬ê¸°, ìœ„ì¹˜ê°€ ë‹¤ì–‘í•¨ (class 80ê°œ)
        - Non-iconic ì´ë¯¸ì§€(ì •í™•íˆ ì–´ë–¤ objectë¥¼ ê°€ë¦¬í‚¤ëŠ”ì§€ ëª¨ë¦„)
        - mAP ì‚¬ìš©, IoUë¥¼ 0.50 ~ 0.95 ìœ ë™ì  ì ìš©
- í¬ê²Œ one-stage, two-stage detector ê°€ ìˆìŒ
- object localizationí•˜ê³  classificationì„ í•˜ëŠ”ì§€, ê°™ì´í•˜ëŠ” ì§€
- one - Yolo, two - fast RCNN

- Yolo(You Only Look Once)
    - One stage detector
    - UltraLyticsë¼ëŠ” íšŒì‚¬ì—ì„œ ê°œë°œ
</div>
</details>
<br>
<a href='https://github.com/Jihwan98/aivle_school/tree/main/2023.03.13.CNN_2.0ver/2_Data_augmentation_and_more' target='_blank'>[Pretrained, Trnasfer Learning ê´€ë ¨ ì½”ë“œ]</a>

<a href='https://github.com/Jihwan98/aivle_school/tree/main/2023.03.15.Object_Detection' target='_blank'>[Object Detection ê´€ë ¨ ì½”ë“œ]</a>

</div>
</details>

## ğŸ’¡ 31ì¼ì°¨. TIL

<details>
<summary>31ì¼ì°¨(3/16) Object Detection ì •ë¦¬!ğŸŒŸ</summary>
<div markdown="1">

<a href='https://github.com/Jihwan98/aivle_school/tree/main/2023.03.15.Object_Detection' target='_blank'>[Object Detection ê´€ë ¨ ì½”ë“œ]</a>

## âœ… Object Detection
Object Detection = Classification + Localization = Multi-Labeled Classification + Bounding Box Regression

### âœ”ï¸ Bounding Box
í•˜ë‚˜ì˜ Objectê°€ ë“¤ì–´ìˆëŠ” ìµœì†Œ í¬ê¸°ì˜ ë°•ìŠ¤. êµ¬ì„±ìš”ì†Œë¡œëŠ” ìœ„ì¹˜ ì •ë³´(x, y, w, h)ê°€ ìˆìŒ. ê²°êµ­ ì´ ìœ„ì¹˜ì •ë³´ë¥¼ Regression í•™ìŠµí•˜ê²Œ ëœë‹¤. ê·¸ë¦¬ê³  ì´ ë°•ìŠ¤ë¡œ IoU(Intersection over Union)ë¥¼ ê³„ì‚°í•œë‹¤. IoU ê°’ì€ 0 ~ 1ì˜ ê°’ì´ë©° ë†’ì„ ìˆ˜ë¡ ë§ì´ ê²¹ì¹˜ëŠ” ê²ƒì´ë‹¤.

### âœ”ï¸ Class Classification
Bounding Boxì— ìˆëŠ” Objectë¥¼ Class Classification í•œë‹¤.

### âœ”ï¸ Confidence Score
Bounding Boxì— ë¬¼ì²´ê°€ ìˆì„ í™•ë¥ . ëª¨ë¸ ë§ˆë‹¤ ë‹¤ë¥´ì§€ë§Œ YOLOì—ì„œëŠ” Bounding Boxì— ë¬¼ì²´ê°€ ìˆì„ í™•ë¥  x Class í™•ë¥ ì´ë‹¤.

### âœ”ï¸ CNNì´ Object Detectionì—ì„œ í•˜ëŠ” ì—­í• 
**Back Bone**ìœ¼ë¡œ ì“°ì„. CNNêµ¬ì¡°ê°€ ìœ„ì¹˜ ì •ë³´ Featureë¥¼ ì˜ ê°€ì ¸ì˜¬ ê±°ë¼ëŠ” ê¸°ëŒ€ë¥¼ í•œ ê²ƒ(ImageNetì„ í†µí•´ ì˜ í•™ìŠµëœ ëª¨ë¸ì„ ê°€ì ¸ë‹¤ ì“°ë©´ ì•ˆë ê¹Œ?) - VGG, Inception, ResNet ë“±ë“± ..

> **Head** : ìš°ë¦¬ ë¬¸ì œì— ë§ê²Œ ë³€í˜•í•˜ëŠ” ë¶€ë¶„ (ë’·ë‹¨ ë¶€ë¶„)<br>
> **Neck** : Back Boneê³¼ Headë¥¼ ì—°ê²°í•˜ëŠ” ë¶€ë¶„
{: .prompt-tip}

### âœ”ï¸ ì£¼ìš” í•™ìŠµ ë°ì´í„°
**Pascal VOC Dataset**

- mAP(mean Average Precision) ë“±ì¥
- ì´ 20ê°œì˜ class
- 2007ë…„ 2012ë…„ ë°ì´í„°ì…‹ì´ ë²¤ì¹˜ë§ˆí¬ ë°ì´í„°ì…‹ìœ¼ë¡œ ì£¼ë¡œ ì“°ì˜€ìŒ

**COCO Datasetâœ¨**

- ê¸°ì¡´ ë°ì´í„°ì…‹(Pascal VOC)ì— ëŒ€í•œ ë¬¸ì œ ì œê¸°
    - ì´ë¯¸ì§€ ì•ˆì˜ objectê°€ í¬ë‹¤.
    - objectê°€ ì´ë¯¸ì§€ ì¤‘ì•™ì— ìˆë‹¤.
    - objectì˜ ì¢…ë¥˜ê°€ ì ë‹¤(20ê°œ)
- í˜„ì¬ ë§ì´ ì“°ì´ëŠ” ë°ì´í„°ì…‹
- objectì˜ í¬ê¸°, ìœ„ì¹˜ê°€ ë‹¤ì–‘í•˜ê³  80ê°œì˜ classê°€ ìˆìŒ
- Non-iconic ì´ë¯¸ì§€ê°€ ì¡´ì¬(ì •í™•íˆ ì–´ë–¤ objectë¥¼ ê°€ë¦¬í‚¤ëŠ”ì§€ ëª¨ë¦„)
- mAP ì‚¬ìš©, IoUë¥¼ 0.50 ~ 0.95 ìœ ë™ì  ì ìš©

---

YOLO ì‹¤ìŠµì„ ì§„í–‰í–ˆë‹¤. ìƒê°ë³´ë‹¤ Object Detectê°€ ì˜ë˜ì–´ì„œ ë†€ë¬ë‹¤. Object Detection ë¶€ë¶„ì€ ì²˜ìŒí•´ë´ì„œ ì¬ë°Œê¸°ë„ í–ˆê³  ì‹ ê¸°í–ˆë‹¤. ê·¸ ì›ë¦¬ê°€ ë„ˆë¬´ ê¶ê¸ˆí•´ì„œ ì´í•´í•˜ê¸° ìœ„í•´ì„œ í˜¼ì ì´ê²ƒì €ê²ƒ ì°¾ì•„ë³´ëŠ” ì¤‘ì´ë‹¤.

> `NMS(Non Maximum Suppression)`ì™€ `Anchor Box` ê°œë… ì´í•´í•˜ê¸°
{: .prompt-tip}

</div>
</details>